{"version":3,"file":"main.umd.js","sources":["../src/palettes.js","../src/index.js"],"sourcesContent":["\"use strict\";\n\n//TODO: make _init attributes optional\n\nexport default {\n    light : {\n        bg_color: \"#E0E0E0\",\n        bg_border_color: \"#BDBDBD\",\n        track_bg_color: \"#CFD8DC\",\n        track_color_init: \"#64B5F6\",\n        track_color: \"#42A5F5\",\n        cursor_color_init: \"#64B5F6\",\n        cursor_color: \"#42A5F5\",\n        markers_color: \"#9E9E9E\",\n        font_color: \"#424242\",\n    },\n    light2 : {\n        bg_color: \"#B1DAEE\",\n        bg_border_color: \"#569DC0\",\n        track_bg_color: \"#B1DAEE\",\n        track_color_init: \"#569DC0\",\n        track_color: \"#1D6D93\",\n        cursor_color_init: \"#569DC0\",\n        cursor_color: \"#1D6D93\",\n        markers_color: \"#3680A4\",\n        font_color: \"#1D6D93\",\n    },\n    dark: {\n        bg_color: \"#000000\",\n        bg_border_color: \"#569DC0\",\n        track_bg_color: \"#424242\",\n        track_color_init: \"#FDD835\",\n        track_color: \"#FFEC00\",\n        cursor_color_init: \"#569DC0\",\n        cursor_color: \"#FDD835\",\n        markers_color: \"#3680A4\",\n        font_color: \"#FFEA00\",\n    }\n}\n","\n    \"use strict\";\n\n    import palettes from \"./palettes.js\";\n\n    // FIXME: remove console usage for IE compatibility\n\n    /**\n     *\n     * @param elem DIV or SVN element\n     * @param conf optional config\n     * @returns {{value, config}}\n     */\n    export default function(elem, conf = {}) {\n\n        // Like a real knob, it's the knob's position that determines the knob's value.\n        // Therefore, the value is computed from the knob's position (angle).\n        // However, the user has the possibility to directly set the value and in that case\n        // the knob's position (angle) will be computed from the value and the knob redrawn\n        // accordingly.\n\n        //\n        // All angles in method parameters are in [degrees] (except for polarToKnobAngle() and getViewboxCoord()).\n        //\n        // By default:\n        // - knob direction is CLOCKWISE\n        // - start position is 6 o'clock (bottom)\n        // - knob angle is:\n        //       0 [deg] angle is a   6 o'clock (bottom)\n        //      90 [deg] angle is at  9 o'clock (left)\n        //     180 [deg] angle is at 12 o'clock (top)\n        //     270 [deg] angle is at  3 o'clock (right)\n        //\n        // Trigonometric functions (sin, cos, ...) operate in polar coordinates,\n        // with 0 angle at 3 o'clock and a counter-clockwise direction.\n        // To convert from \"knob angle\" to \"polar angle\":\n        //\n        //     knob    polar\n        // --------------------\n        //        0      270\n        //       30      240\n        //       90      180\n        //      180       90\n        //      270        0\n        //      330      -60 (add 360 to get a positive equivalent value: -60 + 360 = 300)\n        //\n        // Formula: polar-angle = 270 - knob-angle\n        //\n\n        if (!elem) {\n            throw \"You must pass a DOM node reference to the Knob constructor\";\n        }\n\n        let trace = false;    // when true, will log more details in the console; use enableDebug(), disableDebug() to change\n\n        // It is faster to access a property than to access a variable...\n        // See https://jsperf.com/vars-vs-props-speed-comparison/1\n\n        const NS = \"http://www.w3.org/2000/svg\";\n        const CW = true;    // clock-wise\n        const CCW = !CW;    // counter clock-wise\n\n        //---------------------------------------------------------------------\n        // To simplify the internal coordinates transformations, we set the view box as a 100 by 100 square.\n        // But, if a label is present, then we add 20 to the height (at the bottom) as a placeholder for the label.\n        // In summary:\n        // - 0,0..99,99: the knob itself\n        // - 0,100..99,119: the label, if any\n        const VIEWBOX_WIDTH = 100;\n        // const VIEWBOX_HEIGHT = config.with_label ? 120 : 100;\n        const HALF_WIDTH = 50;      // viewBox/2\n        const HALF_HEIGHT = 50;     // viewBox/2\n\n        let svg_element;\n\n        if (typeof elem === \"string\" || elem instanceof String) {\n            elem = document.querySelector(elem);\n        }\n\n        if (elem.nodeName.toLowerCase() === \"svg\") {\n            svg_element = elem;\n        } else {\n            svg_element = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n            elem.appendChild(svg_element);\n        }\n\n        // For the user convenience, the label can be set with the \"data-label\" attribute.\n        // If another label is set in data-config then this later definition will override data-label.\n        // let default_label = svg_element.dataset.label !== undefined ? svg_element.dataset.label : \"\";\n        let label = elem.dataset.label !== undefined ? elem.dataset.label : false;\n\n        let defaults = {\n\n            // User configurable properties. The colors are defined in the 'palettes', later on.\n\n            // No camelCase because we want to be able to have the same name in data- attributes.\n\n            label: false,\n\n            rotation: CW,\n\n            default_value: 0,\n            initial_value: 0,\n            value_min: 0.0,\n            value_max: 100.0,\n            value_resolution: 1,        // null means ignore\n\n            // split knob:\n            center_zero: false,\n            center_value: null,         // if null, the value will be computed from the min and max in the init() method\n            center_gap: 4,              // only used when center_zero=true; is the width of the gap between the left and right track around the zero value.\n\n            // position:\n            zero_at: 270.0,             // [deg] (polar) the 0 degree will be at 270 polar degrees (6 o'clock).\n            angle_min: 30.0,            // [deg] Angle in knob coordinates (0 at 6 0'clock)\n            angle_max: 330.0,           // [deg] Angle in knob coordinates (0 at 6 0'clock)\n\n            // background disk:\n            bg_radius: 32,\n            bg_border_width: 1,\n\n            // track background:\n            track_bg_radius: 40,\n            track_bg_width: 8,\n\n            // track:\n            track_radius: 40,\n            track_width: 8,\n\n            // cursor\n            cursor_radius: 18,          // same unit as radius\n            cursor_length: 10,\n            cursor_width: 4,\n\n            // appearance:\n            palette: \"light\",\n            bg: false,\n            track_bg: true,\n            track: true,\n            cursor: false,\n            // CSS class names\n            linecap: \"butt\",                   // https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-linecap\n\n            // text displayed in the middle of the knob:\n            value_text: true,\n            value_position: HALF_HEIGHT + 8,    // empirical value: HALF_HEIGHT + config.font_size / 3\n            font_family: \"sans-serif\",\n            font_size: 25,\n\n            // callback to get the text to display from the current value\n            display_raw: false,                 // if true, format callback is ignored\n            format_raw: v => Math.round(v),\n            format: v => v,                     // formatting of the displayed value\n            // off_text: null,                     // text to display when raw_value = min\n            // out_of_range_text: null,            // text to display when raw_value is out of range\n\n            font_weight: \"bold\",\n            markers: 0,                         // number of markers; 0 or false to disable\n            markers_radius: 40,\n            markers_length: 8,\n            markers_width: 2,\n\n            class_bg: \"knob-bg\",\n            class_track_bg : \"knob-track-bg\",\n            class_track : \"knob-track\",\n            class_value : \"knob-value\",\n            class_cursor : \"knob-cursor\",\n            class_markers: \"knob-markers\",\n\n            snap_to_steps: false,       // TODO\n\n            // mouse wheel support:\n            mouse_wheel_acceleration: 1,\n\n            onchange: null              // callback function\n        };\n\n        //---------------------------------------------------------------------\n        // Consolidate all configs:\n\n        let data_config = JSON.parse(elem.dataset.config || \"{}\");\n        let c = Object.assign({}, defaults, palettes[defaults.palette], conf, data_config);\n        // we re-assign conf and data_config for the case they override some of the palette colors.\n        let config = Object.assign(c, palettes[c.palette], conf, data_config);\n\n        //---------------------------------------------------------------------\n        // Terminates the SVG element setup:\n\n        let viewbox_height;\n        if (config.label || (config.value_position >= (100 - (config.font_size / 2)))) {\n            // make some room for the label or the value that we want to display below the knob\n            viewbox_height = 120;\n        } else {\n            viewbox_height = 100;\n        }\n\n        // For the use of null argument with setAttributeNS, see https://developer.mozilla.org/en-US/docs/Web/SVG/Namespaces_Crash_Course#Scripting_in_namespaced_XML\n        svg_element.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\");\n        svg_element.setAttributeNS(null, \"viewBox\", `0 0 ${VIEWBOX_WIDTH} ${viewbox_height}`);\n\n        // Center of arc in knob coordinates and in ViewPort\"s pixels relative to the <svg> ClientBoundingRect.\n        let arcCenterXPixels = 0;\n        let arcCenterYPixels = 0; // equal to arcCenterXPixels because the knob is a circle\n\n        //---------------------------------------------------------------------\n        // Pre-computed values to speed-up operations:\n\n        // At the top of the knob, we leave a gap between the left and right tracks.\n        // These are angles that delimit this gap:\n        let left_track_end_angle = 0;     // angle in [degrees]\n        let right_track_start_angle = 0;  // angle in [degrees]\n\n        //---------------------------------------------------------------------\n        // internals\n\n        let value = 0.0;                    // current knob's value [value_min..value_max]\n        let angle = config.angle_min;       // current knob's angle in [deg] and in knob's coordinate (not polar)\n\n        let distance = 0.0;                 // distance from arc center to mouse position\n        let mouse_wheel_direction = 1;      // dependant of the OS\n\n        //---------------------------------------------------------------------\n        // SVG elements, from back to front:\n        let svg_bg = null;           // background disk:\n        let svg_track_bg = null;            // track background; for non zero-centered knobs\n        let svg_track_bg_left = null;       // track background; for zero-centered knobs\n        let svg_track_bg_right = null;      // track background; for zero-centered knobs\n        let svg_track = null;\n        let svg_cursor = null;\n        let svg_divisions = null;\n        let svg_value_text = null;\n\n        //---------------------------------------------------------------------\n        // mouse support\n        let targetRect;\n        let minDeltaY;\n\n        //---------------------------------------------------------------------\n        // true if the current knob value is different from the default value\n        let has_changed = false;    // to spare some getValue() calls when testing if value has changed from default_value\n\n        //---------------------------------------------------------------------\n        // Create the knob:\n\n        init();\n        initValue();\n        draw();\n        attachEventHandlers();\n\n\n        /**\n         * Having a init function allow the knob to be re-configured.\n         */\n        function init() {\n\n            if (trace) console.log(\"init()\");\n\n            if (config.center_zero) {\n                if (!config.center_value) {\n                    config.center_value = getRoundedValue((config.value_max - config.value_min) / 2 + config.value_min);\n                }\n            }\n\n            // At the top of the knob, we leave a gap between the left and right tracks.\n            // 'left_track_end_angle' and 'right_track_start_angle' are the angles that delimit this gap.\n            // Only used if center_zero=true.\n            if (config.linecap === \"butt\") {\n                left_track_end_angle = polarToKnobAngle(Math.acos(-config.center_gap/100.0) * 180.0 / Math.PI);\n                right_track_start_angle = polarToKnobAngle(Math.acos(config.center_gap/100.0) * 180.0 / Math.PI);\n            } else {\n                left_track_end_angle = polarToKnobAngle(Math.acos(-(config.track_width*1.3 + config.center_gap)/100.0) * 180.0 / Math.PI);\n                right_track_start_angle = polarToKnobAngle(Math.acos((config.track_width*1.3 + config.center_gap)/100.0) * 180.0 / Math.PI);\n            }\n\n            // mouse_wheel_direction = _isMacOS() ? -1 : 1; //TODO: really necessary?\n        }\n\n        function initValue() {\n            // set initial value and angle:\n            setValue(config.initial_value ? config.initial_value : config.default_value);\n        }\n\n        /**\n         * Return the value \"rounded\" according to config.value_resolution\n         * @param v value\n         */\n        function getRoundedValue(v) {\n            return config.value_resolution === null ? v : Math.round(v / config.value_resolution) * config.value_resolution;\n        }\n\n        /**\n         *\n         * @param angle [deg] in knob's coordinates\n         * @returns {*}\n         */\n        function getDisplayValue(angle) {\n            if (trace) console.log(\"getDisplayValue\", config.display_raw);\n            let v = getValue(angle);\n            return config.display_raw ? config.format_raw(v) : config.format(v);\n        }\n\n        /**\n         * Trick to adjust the cursor position when the range is odd.\n         */\n        function getCursorCorrection() {\n            let isOdd = n => Math.abs(n % 2) === 1;\n            return isOdd(Math.abs(config.value_max - config.value_min)) ? 0.5 : 0;\n        }\n\n        /**\n         * Get the knob's value determined by the knob's position (angle)\n         * @param a [deg] in knob's coordinates\n         * @returns {number}\n         */\n        function getValue(a) {\n            let p = a === undefined ? angle : a;\n            let v = ((p - config.angle_min) / (config.angle_max - config.angle_min)) * (config.value_max - config.value_min) + config.value_min;\n            return getRoundedValue(v - getCursorCorrection());\n        }\n\n        /**\n         * Set knob's value\n         * @param v\n         */\n        function setValue(v) {\n            if (v < config.value_min) {\n                value = config.value_min;\n            } else if (v > config.value_max) {\n                value = config.value_max;\n            } else {\n                value = v;\n            }\n            setAngle(((v + getCursorCorrection() - config.value_min) / (config.value_max - config.value_min)) * (config.angle_max - config.angle_min) + config.angle_min);\n            if (trace) console.log(`setValue(${v}) angle=` + ((v - config.value_min) / (config.value_max - config.value_min)) * (config.angle_max - config.angle_min) + config.angle_min);\n            return true;\n        }\n\n        /**\n         * Set knob's angle\n         * @param new_angle in [deg]\n         * @param fire_event\n         */\n        function setAngle(new_angle, fire_event) {\n            let prev = angle;\n            let notify = fire_event && (new_angle !== angle);\n            angle = Math.min(Math.max(new_angle, config.angle_min), config.angle_max);\n            if (notify) {\n                // fire the event if the change of angle affect the value:\n                if (getValue(prev) !== getValue()) {\n                    notifyChange();\n                }\n            }\n        }\n\n        /**\n         * Increment (or decrement if the increment is negative) the knob's angle.\n         * @param increment\n         */\n        function incAngle(increment) {\n            setAngle(Math.min(Math.max(angle + increment, config.angle_min), config.angle_max), true);\n        }\n\n        /**\n         * Return polar coordinates angle from our \"knob coordinates\" angle\n         */\n        function knobToPolarAngle(angle) {\n            let a = config.zero_at - angle;\n            if (a < 0) a = a + 360.0;\n            if (trace) console.log(`knobToPolarAngle ${angle} -> ${a}`);\n            return a;\n        }\n\n        /**\n         *\n         * @param angle [deg] with 0 at 3 o'clock\n         * @returns {number}\n         */\n        function polarToKnobAngle(angle) {\n            // \"-\" for changing CCW to CW\n            if (trace) console.log(`polarToKnobAngle ${angle} -> ${(config.zero_at - angle + 360.0) % 360.0}`);\n            return (config.zero_at - angle + 360.0) % 360.0;    // we add 360 to handle negative values down to -360\n        }\n\n        /**\n         * startDrag() must have been called before to init the targetRect variable.\n         */\n        function mouseUpdate(e) {\n\n            // MouseEvent.clientX (standard property: YES)\n            // The clientX read-only property of the MouseEvent interface provides\n            // the horizontal coordinate within the application's client area at which\n            // the event occurred (as opposed to the coordinates within the page).\n            // For example, clicking in the top-left corner of the client area will always\n            // result in a mouse event with a clientX value of 0, regardless of whether\n            // the page is scrolled horizontally. Originally, this property was defined\n            // as a long integer. The CSSOM View Module redefined it as a double float.\n\n            let dxPixels = e.clientX - targetRect.left;\n            let dyPixels = e.clientY - targetRect.top;\n\n            // mouse delta in cartesian coordinate with path center=0,0 and scaled (-1..0..1) relative to path:\n            // <svg> center:       (dx, dy) == ( 0,  0)\n            // <svg> top-left:     (dx, dy) == (-1,  1)\n            // <svg> bottom-right: (dx, dy) == ( 1, -1) (bottom right of the 100x100 viewBox, ignoring the bottom 100x20 for the label)\n            let dx = (dxPixels - arcCenterXPixels) / (targetRect.width / 2);\n            let dy = - (dyPixels - arcCenterYPixels) / (targetRect.width / 2);  // targetRect.width car on a 20px de plus en hauteur pour le label\n\n            if (config.rotation === CCW) dx = - dx;\n\n            // convert to polar coordinates\n            let angle_rad = Math.atan2(dy, dx);\n            if (angle_rad < 0) angle_rad = 2.0*Math.PI + angle_rad;\n\n            if (trace) console.log(`mouseUpdate: position in svg = ${dxPixels}, ${dyPixels} pixels; ${dx.toFixed(3)}, ${dy.toFixed(3)} rel.; angle ${angle_rad.toFixed(3)} rad`);\n\n            setAngle(polarToKnobAngle(angle_rad * 180.0 / Math.PI), true);\n\n            // distance from arc center to mouse position:\n            // distance = Math.sqrt(dx*(HALF_WIDTH/config.track_radius)*dx*(HALF_WIDTH/config.track_radius) + dy*(HALF_HEIGHT/config.track_radius)*dy*(HALF_HEIGHT/config.track_radius));\n        }\n\n        /**\n         *\n         * @param e\n         */\n        function startDrag(e) {\n\n            if (trace) console.log(\"startDrag\");\n\n            e.preventDefault();\n\n            // API: Event.currentTarget\n            //      Identifies the current target for the event, as the event traverses the DOM. It always REFERS TO THE ELEMENT\n            //      TO WHICH THE EVENT HANDLER HAS BEEN ATTACHED, as opposed to event.target which identifies the element on\n            //      which the event occurred.\n            //      https://developer.mozilla.org/en-US/docs/Web/API/Event/currentTarget\n\n            // currentTarget = e.currentTarget;\n\n            // API: Element.getBoundingClientRect() (standard: YES)\n            //      The Element.getBoundingClientRect() method returns the size of an element\n            //      and its POSITION RELATIVE TO THE VIEWPORT.\n            //      The amount of scrolling that has been done of the viewport area (or any other\n            //      scrollable element) is taken into account when computing the bounding rectangle.\n            //      This means that the rectangle's boundary edges (top, left, bottom, and right)\n            //      change their values every time the scrolling position changes (because their\n            //      values are relative to the viewport and not absolute).\n            //      https://developer.mozilla.org/en/docs/Web/API/Element/getBoundingClientRect\n\n            // targetRect = currentTarget.getBoundingClientRect(); // currentTarget must be the <svg...> object\n            targetRect = svg_element.getBoundingClientRect();\n\n            // Note: we must take the boundingClientRect of the <svg> and not the <path> because the <path> bounding rect\n            //       is not constant because it encloses the current arc.\n\n            // By design, the arc center is at equal distance from top and left.\n            arcCenterXPixels = targetRect.width / 2;\n            //noinspection JSSuspiciousNameCombination\n            arcCenterYPixels = arcCenterXPixels;\n\n            document.addEventListener(\"mousemove\", handleDrag, false);\n            document.addEventListener(\"mouseup\", endDrag, false);\n\n            mouseUpdate(e);\n            redraw();\n        }\n\n        /**\n         *\n         * @param e\n         */\n        function handleDrag(e) {\n            e.preventDefault();\n            mouseUpdate(e);\n            redraw();\n        }\n\n        /**\n         *\n         */\n        function endDrag() {\n            if (trace) console.log(\"endDrag\");\n            document.removeEventListener(\"mousemove\", handleDrag, false);\n            document.removeEventListener(\"mouseup\", endDrag, false);\n        }\n\n        /**\n         *\n         * @param e\n         * @returns {boolean}\n         */\n        function mouseWheelHandler(e) {\n\n            // WheelEvent\n            // This is the standard wheel event interface to use. Old versions of browsers implemented the two non-standard\n            // and non-cross-browser-compatible MouseWheelEvent and MouseScrollEvent interfaces. Use this interface and avoid\n            // the latter two.\n            // The WheelEvent interface represents events that occur due to the user moving a mouse wheel or similar input device.\n\n            // https://stackoverflow.com/questions/5527601/normalizing-mousewheel-speed-across-browsers\n            // https://github.com/facebook/fixed-data-table/blob/master/src/vendor_upstream/dom/normalizeWheel.js\n\n            e.preventDefault();\n\n            let dy = e.deltaY;\n\n            if (dy !== 0) {\n                // normalize Y delta\n                if (minDeltaY > Math.abs(dy) || !minDeltaY) {\n                    minDeltaY = Math.abs(dy);\n                }\n            }\n\n            incAngle(dy / minDeltaY * mouse_wheel_direction * config.mouse_wheel_acceleration);\n\n            // TODO: mouse speed detection (https://stackoverflow.com/questions/22593286/detect-measure-scroll-speed)\n\n            redraw();\n\n            return false;\n        }\n\n        /**\n         *\n         * @param e\n         */\n        function startTouch(e) {\n\n            if (trace) console.log(\"startTouch\");\n\n            e.preventDefault(); // necessary to avoid moving all the page\n\n            targetRect = svg_element.getBoundingClientRect();\n\n            // By design, the arc center is at equal distance from top and left.\n            arcCenterXPixels = targetRect.width / 2;\n            //noinspection JSSuspiciousNameCombination\n            arcCenterYPixels = arcCenterXPixels;\n\n            document.addEventListener(\"touchmove\", handleTouch, {passive: false});\n            document.addEventListener(\"touchend\", endTouch);\n\n        }\n\n        /**\n         *\n         * @param e\n         */\n        function handleTouch(e) {\n\n            if (trace) console.log(\"handleTouch\", e.touches);\n\n            e.preventDefault();\n\n            let touchesIndex = e.touches.length - 1;\n\n            let dxPixels = e.touches[touchesIndex].clientX - targetRect.left;\n            let dyPixels = e.touches[touchesIndex].clientY - targetRect.top;\n\n            let dx = (dxPixels - arcCenterXPixels) / (targetRect.width / 2);\n            let dy = - (dyPixels - arcCenterYPixels) / (targetRect.width / 2);  // targetRect.width car on a 20px de plus en hauteur pour le label\n\n            if (config.rotation === CCW) dx = - dx;\n\n            // convert to polar coordinates\n            let angle_rad = Math.atan2(dy, dx);\n            if (angle_rad < 0) angle_rad = 2.0*Math.PI + angle_rad;\n\n            if (trace) console.log(`handleTouch: position in svg = ${dxPixels}, ${dyPixels} pixels; ${dx.toFixed(3)}, ${dy.toFixed(3)} rel.; angle ${angle_rad.toFixed(3)} rad`);\n\n            setAngle(polarToKnobAngle(angle_rad * 180.0 / Math.PI), true);\n\n            redraw();\n\n        }\n\n        /**\n         *\n         */\n        function endTouch() {\n            if (trace) console.log(\"endTouch\");\n            document.removeEventListener(\"touchmove\", handleTouch);\n            document.removeEventListener(\"touchend\", endTouch);\n        }\n\n        /**\n         *\n         */\n        function attachEventHandlers() {\n            if (trace) console.log(\"attach attachEventHandlers\");\n            svg_element.addEventListener(\"mousedown\", function(e) {\n                startDrag(e);\n            });\n            svg_element.addEventListener(\"wheel\", function(e) {\n                mouseWheelHandler(e);\n            });\n            svg_element.addEventListener(\"touchstart\", startTouch, {passive: false});\n        }\n\n        /**\n         *\n         */\n        function notifyChange() {\n            if (trace) console.log(\"knob value has changed\");\n            let value = getValue();     // TODO: cache the value\n            let event = new CustomEvent(\"change\", {\"detail\": value});\n            //svg_element.dispatchEvent(event);\n            elem.dispatchEvent(event);\n            if (config.onchange) {\n                config.onchange(value);\n            }\n        }\n\n        /**\n         * Utility function to configure the mousewheel direction.\n         * @returns {*}\n         * @private\n         */\n        function _isMacOS() {\n            return [\"Macintosh\", \"MacIntel\", \"MacPPC\", \"Mac68K\"].indexOf(window.navigator.platform) !== -1;\n        }\n\n        /**\n         * Return viewBox X,Y coordinates\n         * @param angle in [degree] (polar, 0 at 3 o'clock)\n         * @param radius; defaults to config.radius\n         * @returns {{x: number, y: number}}\n         */\n        function getViewboxCoord(angle, radius) {\n            let a = angle * Math.PI / 180.0;\n            let r = radius === undefined ? config.track_radius : radius;\n            let x = Math.cos(a) * r;\n            let y = Math.sin(a) * r;\n            return {\n                x: config.rotation === CW ? (HALF_WIDTH + x) : (HALF_WIDTH - x),\n                y: HALF_HEIGHT - y\n            }\n        }\n\n        /**\n         *\n         * @param from_angle in [degree] in knob's coordinates\n         * @param to_angle in [degree] in knob's coordinates\n         * @param radius\n         */\n        function getArc(from_angle, to_angle, radius) {\n\n            if (trace) console.group(`getArc(${from_angle}, ${to_angle}, ${radius})`);\n\n            // SVG d: \"A rx,ry xAxisRotate LargeArcFlag,SweepFlag x,y\".\n            // SweepFlag is either 0 or 1, and determines if the arc should be swept in a clockwise (1), or anti-clockwise (0) direction\n            // ref: https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d\n\n            let a0 = knobToPolarAngle(from_angle);\n            let a1 = knobToPolarAngle(to_angle);\n\n            // little trick to force a full arc (360deg) when from=0 and to=360\n            if (from_angle !== to_angle) {\n                // with this we make sure that x1 will be different than x0 within the path definition\n                a0 -= 0.0001;\n                a1 += 0.0001;\n            }\n\n            let {x: x0, y: y0} = getViewboxCoord(a0, radius);\n            let {x: x1, y: y1} = getViewboxCoord(a1, radius);\n\n            let delta_angle = (a0 - a1 + 360.0) % 360.0;\n\n            let large_arc = delta_angle < 180.0 ? 0 : 1;\n            let arc_direction = config.rotation === CW ? 1 : 0;\n\n            let p = `M ${x0},${y0} A ${radius},${radius} 0 ${large_arc},${arc_direction} ${x1},${y1}`;\n\n            if (trace) console.groupEnd();\n            if (trace) console.log(\"arc: \" + p);\n\n            return p;\n        }\n\n        /**\n         *\n         * @returns {*}\n         */\n        function getTrackPath() {\n\n            if (trace) console.log(\"getTrackPath()\");\n\n            let p = null;\n\n            if (config.center_zero) {\n\n                if (Array.isArray(config.center_value)) {\n                    // let v = getValue();\n                    // console.log('center value is an array; getValue=', getValue(), typeof v);\n                    if (config.center_value.includes(getValue())) {\n                        if (trace) console.log(\"getTrackPath: center position, track not drawn\");\n                        // track is not drawn when the value is at center\n                        return p;\n                    }\n                } else {\n                    if (getValue() === config.center_value) {\n                        if (trace) console.log(\"getTrackPath: center position, track not drawn\");\n                        // track is not drawn when the value is at center\n                        return p;\n                    }\n                }\n\n                // we assume the split is at 180 [deg] (knob\"s angle)\n                if (angle < 180) {\n                    p = getArc(Math.min(angle, left_track_end_angle), left_track_end_angle, config.track_radius);\n                } else if (angle > 180) {\n                    p = getArc(right_track_start_angle, Math.max(angle, right_track_start_angle), config.track_radius);\n                }\n\n            } else {\n                p = getArc(config.angle_min, angle, config.track_radius);\n            }\n\n            return p;\n        }\n\n        /**\n         *\n         */\n        function draw_background() {\n\n            if (trace) console.log(\"draw_background()\", config.bg);\n\n            if (!config.bg) return;\n\n            // For the use of null argument with setAttributeNS, see https://developer.mozilla.org/en-US/docs/Web/SVG/Namespaces_Crash_Course#Scripting_in_namespaced_XML\n\n            //\n            // back disk:\n            //\n            svg_bg = document.createElementNS(NS, \"circle\");\n            svg_bg.setAttributeNS(null, \"cx\", `${HALF_WIDTH}`);\n            svg_bg.setAttributeNS(null, \"cy\", `${HALF_HEIGHT}`);\n            svg_bg.setAttributeNS(null, \"r\", `${config.bg_radius}`);\n            svg_bg.setAttribute(\"fill\", `${config.bg_color}`);\n            svg_bg.setAttribute(\"stroke\", `${config.bg_border_color}`);\n            svg_bg.setAttribute(\"stroke-width\", `${config.bg_border_width}`);\n            svg_bg.setAttribute(\"class\", config.class_bg);\n            svg_element.appendChild(svg_bg);\n        }\n\n        /**\n         *\n         */\n        function draw_markers() {\n\n            if (trace) console.log(\"draw_markers()\", config.markers);\n\n            if (!config.markers) return;\n\n            let p = \"\";\n            let step = (config.angle_max - config.angle_min) / config.markers;\n            for (let a = config.angle_min; a <= config.angle_max; a += step) {\n                let from = getViewboxCoord(knobToPolarAngle(a), config.markers_radius);    // getViewboxCoord(angle, radius)\n                let to = getViewboxCoord(knobToPolarAngle(a), config.markers_radius + config.markers_length);\n                p += `M ${from.x},${from.y} L ${to.x},${to.y} `;\n            }\n\n            svg_divisions = document.createElementNS(NS, \"path\");\n            svg_divisions.setAttributeNS(null, \"d\", p);\n            svg_divisions.setAttribute(\"stroke\", `${config.markers_color}`);\n            svg_divisions.setAttribute(\"stroke-width\", `${config.markers_width}`);\n            svg_divisions.setAttribute(\"stroke-linecap\", config.linecap);\n            svg_divisions.setAttribute(\"class\", config.class_markers);\n            svg_element.appendChild(svg_divisions);\n        }\n\n/*\n        function draw_units() {\n            let pos = getViewboxCoord(angle_min_polar, config.divisions_radius);    // getViewboxCoord(angle, radius)\n            svg_value_text = document.createElementNS(NS, \"text\");\n            svg_value_text.setAttributeNS(null, \"x\", `${pos.x}`);\n            svg_value_text.setAttributeNS(null, \"y\", `${pos.y}`);\n            // svg_value_text.setAttribute(\"text-anchor\", \"middle\");\n            svg_value_text.setAttribute(\"cursor\", \"default\");\n            svg_value_text.setAttribute(\"font-family\", config.font_family);\n            svg_value_text.setAttribute(\"font-size\", `10`);\n            // svg_value_text.setAttribute(\"font-weight\", `${config.font_weight}`);\n            svg_value_text.setAttribute(\"fill\", config.font_color);\n            // svg_value_text.setAttribute(\"class\", config.class_value);\n            // svg_value_text.textContent = getDisplayValue();\n            svg_value_text.textContent = config.value_min.toString();\n            svg_element.appendChild(svg_value_text);\n        }\n*/\n\n        /**\n         *\n         */\n        function draw_track_background() {\n\n            if (trace) console.log(\"draw_track_background()\", config.track_bg);\n\n            // For the use of null argument with setAttributeNS, see https://developer.mozilla.org/en-US/docs/Web/SVG/Namespaces_Crash_Course#Scripting_in_namespaced_XML\n\n            if (!config.track_bg) return;\n\n            //\n            // track background:\n            //\n            if (config.center_zero) {\n\n                // left track background\n                svg_track_bg_left = document.createElementNS(NS, \"path\");\n                svg_track_bg_left.setAttributeNS(null, \"d\", getArc(config.angle_min, left_track_end_angle, config.track_bg_radius));\n                svg_track_bg_left.setAttribute(\"stroke\", `${config.track_bg_color}`);\n                svg_track_bg_left.setAttribute(\"stroke-width\", `${config.track_bg_width}`);\n                svg_track_bg_left.setAttribute(\"stroke-linecap\", config.linecap);\n                svg_track_bg_left.setAttribute(\"fill\", \"transparent\");\n                svg_track_bg_left.setAttribute(\"class\", config.class_track_bg);\n                svg_element.appendChild(svg_track_bg_left);\n\n                // right track background\n                svg_track_bg_right = document.createElementNS(NS, \"path\");\n                svg_track_bg_right.setAttributeNS(null, \"d\", getArc(right_track_start_angle, config.angle_max, config.track_bg_radius));\n                svg_track_bg_right.setAttribute(\"stroke\", `${config.track_bg_color}`);\n                svg_track_bg_right.setAttribute(\"stroke-width\", `${config.track_bg_width}`);\n                svg_track_bg_right.setAttribute(\"stroke-linecap\", config.linecap);\n                svg_track_bg_right.setAttribute(\"fill\", \"transparent\");\n                svg_track_bg_right.setAttribute(\"class\", config.class_track_bg);\n                svg_element.appendChild(svg_track_bg_right);\n\n            } else {\n\n                svg_track_bg = document.createElementNS(NS, \"path\");\n                svg_track_bg.setAttributeNS(null, \"d\", getArc(config.angle_min, config.angle_max, config.track_bg_radius));\n                svg_track_bg.setAttribute(\"stroke\", `${config.track_bg_color}`);\n                svg_track_bg.setAttribute(\"stroke-width\", `${config.track_bg_width}`);\n                svg_track_bg.setAttribute(\"fill\", \"transparent\");\n                svg_track_bg.setAttribute(\"stroke-linecap\", config.linecap);\n                svg_track_bg.setAttribute(\"class\", config.class_track_bg);\n                svg_element.appendChild(svg_track_bg);\n\n            }\n        }\n\n        /**\n         *\n         */\n        function draw_track() {\n\n            if (trace) console.log(\"draw_track()\", config.track);\n\n            if (!config.track) return;\n            let p = getTrackPath();\n            if (p) {\n                svg_track = document.createElementNS(NS, \"path\");\n                svg_track.setAttributeNS(null, \"d\", p);\n                svg_track.setAttribute(\"stroke\", `${config.track_color_init}`);\n                svg_track.setAttribute(\"stroke-width\", `${config.track_width}`);\n                svg_track.setAttribute(\"fill\", \"transparent\");\n                svg_track.setAttribute(\"stroke-linecap\", config.linecap);\n                svg_track.setAttribute(\"class\", config.class_track);\n                svg_element.appendChild(svg_track);\n            }\n        }\n\n        /**\n         *\n         * @returns {string}\n         */\n        function getTrackCursor() {\n            let a = knobToPolarAngle(angle);\n            let from = getViewboxCoord(a, config.cursor_radius);\n            let to = getViewboxCoord(a, config.cursor_radius + config.cursor_length);\n            return `M ${from.x},${from.y} L ${to.x},${to.y}`;\n        }\n\n        /**\n         *\n         */\n        function draw_cursor() {\n\n            if (trace) console.log(\"draw_cursor()\", config.cursor);\n\n            if (!config.cursor) return;\n\n            let p = getTrackCursor();\n            if (p) {\n                svg_cursor = document.createElementNS(NS, \"path\");\n                svg_cursor.setAttributeNS(null, \"d\", p);\n                svg_cursor.setAttribute(\"stroke\", `${config.cursor_color_init}`);\n                svg_cursor.setAttribute(\"stroke-width\", `${config.cursor_width}`);\n                svg_cursor.setAttribute(\"fill\", \"transparent\");\n                svg_cursor.setAttribute(\"stroke-linecap\", config.linecap);\n                svg_cursor.setAttribute(\"class\", config.class_cursor);\n                svg_element.appendChild(svg_cursor);\n            }\n        }\n\n        /**\n         *\n         */\n        function draw_value() {\n\n            if (trace) console.log(\"draw_value\", config.value_text);\n\n            if (!config.value_text) return;\n\n            svg_value_text = document.createElementNS(NS, \"text\");\n            svg_value_text.setAttributeNS(null, \"x\", `${HALF_WIDTH}`);\n            svg_value_text.setAttributeNS(null, \"y\", `${config.value_position}`);\n            svg_value_text.setAttribute(\"text-anchor\", \"middle\");\n            svg_value_text.setAttribute(\"cursor\", \"default\");\n            svg_value_text.setAttribute(\"font-family\", config.font_family);\n            svg_value_text.setAttribute(\"font-size\", `${config.font_size}`);\n            svg_value_text.setAttribute(\"font-weight\", `${config.font_weight}`);\n            svg_value_text.setAttribute(\"fill\", config.font_color);\n            svg_value_text.setAttribute(\"class\", config.class_value);\n            svg_value_text.textContent = getDisplayValue();\n            svg_element.appendChild(svg_value_text);\n        }\n\n        /**\n         *\n         */\n        function draw() {\n\n            if (trace) console.log(\"draw()\", config);\n\n            draw_background();\n            draw_track_background();\n            draw_markers();\n            // draw_units();\n            draw_track();\n            draw_cursor();\n            draw_value();\n        }\n\n        /**\n         *\n         */\n        function redraw() {\n\n            if (trace) console.log(\"redraw()\", config);\n\n            let p = getTrackPath();\n            if (p) {\n                if (svg_track) {\n                    if (trace) console.log(\"redraw track already exist, update d\");\n                    svg_track.setAttributeNS(null, \"d\", p);\n                } else {\n                    if (trace) console.log(\"redraw draw_track\");\n                    draw_track();\n                }\n            } else {\n                if (svg_track) {\n                    if (trace) console.log(\"redraw track already exist, hide it\");\n                    svg_track.setAttributeNS(null, \"d\", \"\");    // we hide the track\n                }\n            }\n\n            if (!has_changed) {\n                has_changed = getValue() !== config.default_value;\n                if (has_changed) {\n                    if (svg_track) {\n                        svg_track.setAttribute(\"stroke\", `${config.track_color}`);\n                    }\n                }\n            }\n\n            if (svg_cursor) {\n                p = getTrackCursor();\n                if (p) {\n                    if (trace) console.log(\"redraw cursor\");\n                    svg_cursor.setAttributeNS(null, \"d\", p);\n                    if (has_changed) {\n                        svg_cursor.setAttribute(\"stroke\", `${config.cursor_color}`);\n                    }\n                }\n            }\n\n            if (svg_value_text) {\n                if (trace) console.log(\"redraw svg_value_text\");\n                svg_value_text.textContent = getDisplayValue();\n            }\n        }\n\n        /**\n         *\n         */\n        return {\n            set value(v) {\n                // console.group(\"value setter\");\n                setValue(v);\n                redraw();\n                // console.groupEnd();\n            },\n            set config(new_config) {\n                // console.group(\"config setter\");\n                config = Object.assign({}, defaults, config, new_config);\n                init();\n                redraw();\n                // console.groupEnd();\n            },\n            setConfigValue: function(attribute, value) {\n                // console.group(\"setConfigValue\");\n                config[attribute] = value;\n                init();\n                redraw();\n                // console.groupEnd();\n            },\n            initValue,\n            enableDebug: function() {\n                trace = true;\n            },\n            disableDebug: function() {\n                trace = false;\n            }\n        };\n\n    }\n"],"names":["light","bg_color","bg_border_color","track_bg_color","track_color_init","track_color","cursor_color_init","cursor_color","markers_color","font_color","light2","dark","elem","conf","svg_element","trace","NS","CW","CCW","HALF_WIDTH","HALF_HEIGHT","String","document","querySelector","nodeName","toLowerCase","createElementNS","appendChild","viewbox_height","defaults","label","rotation","default_value","initial_value","value_min","value_max","value_resolution","center_zero","center_value","center_gap","zero_at","angle_min","angle_max","bg_radius","bg_border_width","track_bg_radius","track_bg_width","track_radius","track_width","cursor_radius","cursor_length","cursor_width","palette","bg","track_bg","track","cursor","linecap","value_text","value_position","font_family","font_size","display_raw","format_raw","v","Math","round","format","font_weight","markers","markers_radius","markers_length","markers_width","class_bg","class_track_bg","class_track","class_value","class_cursor","class_markers","snap_to_steps","mouse_wheel_acceleration","onchange","data_config","JSON","parse","dataset","config","c","Object","assign","palettes","setAttributeNS","targetRect","minDeltaY","arcCenterXPixels","arcCenterYPixels","left_track_end_angle","right_track_start_angle","angle","svg_bg","svg_track_bg","svg_track_bg_left","svg_track_bg_right","svg_track","svg_cursor","svg_divisions","svg_value_text","has_changed","init","console","log","getRoundedValue","polarToKnobAngle","acos","PI","initValue","setValue","getDisplayValue","getValue","getCursorCorrection","n","abs","a","undefined","setAngle","new_angle","fire_event","prev","notify","min","max","value","event","CustomEvent","dispatchEvent","notifyChange","knobToPolarAngle","mouseUpdate","e","dxPixels","clientX","left","dyPixels","clientY","top","dx","width","dy","angle_rad","atan2","toFixed","handleDrag","preventDefault","redraw","endDrag","removeEventListener","handleTouch","touches","touchesIndex","length","endTouch","getViewboxCoord","radius","r","x","cos","y","sin","getArc","from_angle","to_angle","group","a0","a1","p","x0","y0","groupEnd","getTrackPath","Array","isArray","includes","draw_track","setAttribute","getTrackCursor","from","to","textContent","step","draw_markers","draw_cursor","addEventListener","getBoundingClientRect","startDrag","deltaY","mouseWheelHandler","passive","new_config","setConfigValue","attribute","enableDebug","disableDebug"],"mappings":"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"}