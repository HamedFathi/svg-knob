!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.svgKnob=e():t.svgKnob=e()}(window,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=1)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={light:{bg_color:"#E0E0E0",bg_border_color:"#BDBDBD",track_bg_color:"#CFD8DC",track_color_init:"#64B5F6",track_color:"#42A5F5",cursor_color_init:"#64B5F6",cursor_color:"#42A5F5",markers_color:"#9E9E9E",font_color:"#424242"},light2:{bg_color:"#B1DAEE",bg_border_color:"#569DC0",track_bg_color:"#B1DAEE",track_color_init:"#569DC0",track_color:"#1D6D93",cursor_color_init:"#569DC0",cursor_color:"#1D6D93",markers_color:"#3680A4",font_color:"#1D6D93"},dark:{bg_color:"#000000",bg_border_color:"#569DC0",track_bg_color:"#424242",track_color_init:"#FDD835",track_color:"#FFEC00",cursor_color_init:"#569DC0",cursor_color:"#FDD835",markers_color:"#3680A4",font_color:"#FFEA00"}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t)throw"You must pass a DOM node reference to the Knob constructor";var r=!1,n="http://www.w3.org/2000/svg",o=!0,l=!o,i=50,s=50,u=void 0;("string"==typeof t||t instanceof String)&&(t=document.querySelector(t)),"svg"===t.nodeName.toLowerCase()?u=t:(u=document.createElementNS("http://www.w3.org/2000/svg","svg"),t.appendChild(u));void 0!==t.dataset.label&&t.dataset.label;var c={label:!1,rotation:o,default_value:0,initial_value:0,value_min:0,value_max:100,value_resolution:1,center_zero:!1,center_value:null,center_gap:4,zero_at:270,angle_min:30,angle_max:330,bg_radius:32,bg_border_width:1,track_bg_radius:40,track_bg_width:8,track_radius:40,track_width:8,cursor_radius:18,cursor_length:10,cursor_width:4,palette:"light",bg:!1,track_bg:!0,track:!0,cursor:!1,linecap:"butt",value_text:!0,value_position:s+8,format:function(t){return t},font_family:"sans-serif",font_size:25,font_weight:"bold",markers:0,markers_radius:40,markers_length:8,markers_width:2,class_bg:"knob-bg",class_track_bg:"knob-track-bg",class_track:"knob-track",class_value:"knob-value",class_cursor:"knob-cursor",class_markers:"knob-markers",snap_to_steps:!1,mouse_wheel_acceleration:1,onchange:null},_=JSON.parse(t.dataset.config||"{}"),d=Object.assign({},c,a.default[c.palette],e,_),b=Object.assign(d,a.default[d.palette],e,_),g=void 0;g=b.label||b.value_position>=100-b.font_size/2?120:100,u.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),u.setAttributeNS(null,"viewBox","0 0 100 "+g);var m=0,h=0,v=0,f=0,p=b.angle_min,k=1,A=null,w=null,x=null,E=null,M=null,D=null,S=null,N=null,y=void 0,C=void 0,F=!1;function P(){b.center_zero&&(b.center_value||(b.center_value=L((b.value_max-b.value_min)/2+b.value_min))),O(b.initial_value?b.initial_value:b.default_value),"butt"===b.linecap?(v=T(180*Math.acos(-b.center_gap/100)/Math.PI),f=T(180*Math.acos(b.center_gap/100)/Math.PI)):(v=T(180*Math.acos(-(1.3*b.track_width+b.center_gap)/100)/Math.PI),f=T(180*Math.acos((1.3*b.track_width+b.center_gap)/100)/Math.PI))}function L(t){return null===b.value_resolution?t:Math.round(t/b.value_resolution)*b.value_resolution}function z(t){var e=j(t);return b.format(e)}function j(t){return L(((void 0===t?p:t)-b.angle_min)/(b.angle_max-b.angle_min)*(b.value_max-b.value_min)+b.value_min)}function O(t){return console.log("setValue("+t+")"),t<b.value_min?b.value_min:t>b.value_max?b.value_max:t,B((t-b.value_min)/(b.value_max-b.value_min)*(b.angle_max-b.angle_min)+b.angle_min),!0}function B(e,n){var o=p,a=n&&e!==p;p=Math.min(Math.max(e,b.angle_min),b.angle_max),a&&j(o)!==j()&&function(){r&&console.log("knob value has changed");var e=j(),n=new CustomEvent("change",{detail:e});t.dispatchEvent(n),b.onchange&&b.onchange(e)}()}function I(t){var e=b.zero_at-t;return e<0&&(e+=360),r&&console.log("knobToPolarAngle "+t+" -> "+e),e}function T(t){return r&&console.log("polarToKnobAngle "+t+" -> "+(b.zero_at-t+360)%360),(b.zero_at-t+360)%360}function K(t){var e=t.clientX-y.left,n=t.clientY-y.top,o=(e-m)/(y.width/2),a=-(n-h)/(y.width/2);b.rotation===l&&(o=-o);var i=Math.atan2(a,o);i<0&&(i=2*Math.PI+i),r&&console.log("mouseUpdate: position in svg = "+e+", "+n+" pixels; "+o.toFixed(3)+", "+a.toFixed(3)+" rel.; angle "+i.toFixed(3)+" rad"),B(T(180*i/Math.PI),!0)}function Y(t){t.preventDefault(),K(t),Z()}function R(){r&&console.log("endDrag"),document.removeEventListener("mousemove",Y,!1),document.removeEventListener("mouseup",R,!1)}function X(t){r&&console.log("startTouch"),t.preventDefault(),y=u.getBoundingClientRect(),m=y.width/2,h=m,document.addEventListener("touchmove",q,{passive:!1}),document.addEventListener("touchend",H)}function q(t){r&&console.log("handleTouch",t.touches),t.preventDefault();var e=t.touches.length-1,n=t.touches[e].clientX-y.left,o=t.touches[e].clientY-y.top,a=(n-m)/(y.width/2),i=-(o-h)/(y.width/2);b.rotation===l&&(a=-a);var s=Math.atan2(i,a);s<0&&(s=2*Math.PI+s),r&&console.log("handleTouch: position in svg = "+n+", "+o+" pixels; "+a.toFixed(3)+", "+i.toFixed(3)+" rel.; angle "+s.toFixed(3)+" rad"),B(T(180*s/Math.PI),!0),Z()}function H(){r&&console.log("endTouch"),document.removeEventListener("touchmove",q),document.removeEventListener("touchend",H)}function J(t,e){var r=t*Math.PI/180,n=void 0===e?b.track_radius:e,a=Math.cos(r)*n,l=Math.sin(r)*n;return{x:b.rotation===o?i+a:i-a,y:s-l}}function U(t,e,n){r&&console.group("getArc("+t+", "+e+", "+n+")");var a=I(t),l=I(e);t!==e&&(a-=1e-4,l+=1e-4);var i=J(a,n),s=i.x,u=i.y,c=J(l,n),_=c.x,d=c.y,g="M "+s+","+u+" A "+n+","+n+" 0 "+((a-l+360)%360<180?0:1)+","+(b.rotation===o?1:0)+" "+_+","+d;return r&&console.groupEnd(),r&&console.log("arc: "+g),g}function V(){var t=null;if(b.center_zero){if(j()===b.center_value)return r&&console.log("getTrackPath: center position, track not drawn"),t;p<180?t=U(Math.min(p,v),v,b.track_radius):p>180&&(t=U(f,Math.max(p,f),b.track_radius))}else t=U(b.angle_min,p,b.track_radius);return t}function G(){if(b.track){var t=V();t&&((M=document.createElementNS(n,"path")).setAttributeNS(null,"d",t),M.setAttribute("stroke",""+b.track_color_init),M.setAttribute("stroke-width",""+b.track_width),M.setAttribute("fill","transparent"),M.setAttribute("stroke-linecap",b.linecap),M.setAttribute("class",b.class_track),u.appendChild(M))}}function Q(){var t=I(p),e=J(t,b.cursor_radius),r=J(t,b.cursor_radius+b.cursor_length);return"M "+e.x+","+e.y+" L "+r.x+","+r.y}function W(){b.bg&&((A=document.createElementNS(n,"circle")).setAttributeNS(null,"cx",""+i),A.setAttributeNS(null,"cy",""+s),A.setAttributeNS(null,"r",""+b.bg_radius),A.setAttribute("fill",""+b.bg_color),A.setAttribute("stroke",""+b.bg_border_color),A.setAttribute("stroke-width",""+b.bg_border_width),A.setAttribute("class",b.class_bg),u.appendChild(A)),b.track_bg&&(b.center_zero?((x=document.createElementNS(n,"path")).setAttributeNS(null,"d",U(b.angle_min,v,b.track_bg_radius)),x.setAttribute("stroke",""+b.track_bg_color),x.setAttribute("stroke-width",""+b.track_bg_width),x.setAttribute("stroke-linecap",b.linecap),x.setAttribute("fill","transparent"),x.setAttribute("class",b.class_track_bg),u.appendChild(x),(E=document.createElementNS(n,"path")).setAttributeNS(null,"d",U(f,b.angle_max,b.track_bg_radius)),E.setAttribute("stroke",""+b.track_bg_color),E.setAttribute("stroke-width",""+b.track_bg_width),E.setAttribute("stroke-linecap",b.linecap),E.setAttribute("fill","transparent"),E.setAttribute("class",b.class_track_bg),u.appendChild(E)):((w=document.createElementNS(n,"path")).setAttributeNS(null,"d",U(b.angle_min,b.angle_max,b.track_bg_radius)),w.setAttribute("stroke",""+b.track_bg_color),w.setAttribute("stroke-width",""+b.track_bg_width),w.setAttribute("fill","transparent"),w.setAttribute("stroke-linecap",b.linecap),w.setAttribute("class",b.class_track_bg),u.appendChild(w))),function(){if(b.markers){for(var t="",e=(b.angle_max-b.angle_min)/b.markers,r=b.angle_min;r<=b.angle_max;r+=e){var o=J(I(r),b.markers_radius),a=J(I(r),b.markers_radius+b.markers_length);t+="M "+o.x+","+o.y+" L "+a.x+","+a.y+" "}(S=document.createElementNS(n,"path")).setAttributeNS(null,"d",t),S.setAttribute("stroke",""+b.markers_color),S.setAttribute("stroke-width",""+b.markers_width),S.setAttribute("stroke-linecap",b.linecap),S.setAttribute("class",b.class_markers),u.appendChild(S)}}(),G(),function(){if(b.cursor){var t=Q();t&&((D=document.createElementNS(n,"path")).setAttributeNS(null,"d",t),D.setAttribute("stroke",""+b.cursor_color_init),D.setAttribute("stroke-width",""+b.cursor_width),D.setAttribute("fill","transparent"),D.setAttribute("stroke-linecap",b.linecap),D.setAttribute("class",b.class_cursor),u.appendChild(D))}}(),b.value_text&&((N=document.createElementNS(n,"text")).setAttributeNS(null,"x",""+i),N.setAttributeNS(null,"y",""+b.value_position),N.setAttribute("text-anchor","middle"),N.setAttribute("cursor","default"),N.setAttribute("font-family",b.font_family),N.setAttribute("font-size",""+b.font_size),N.setAttribute("font-weight",""+b.font_weight),N.setAttribute("fill",b.font_color),N.setAttribute("class",b.class_value),N.textContent=z(),u.appendChild(N))}function Z(){var t=V();t?M?M.setAttributeNS(null,"d",t):G():M&&M.setAttributeNS(null,"d",""),F||(F=j()!==b.default_value)&&M&&M.setAttribute("stroke",""+b.track_color),(t=Q())&&D&&(D.setAttributeNS(null,"d",t),F&&D.setAttribute("stroke",""+b.cursor_color)),N&&(N.textContent=z())}return P(),W(),console.log("attach attachEventHandlers"),u.addEventListener("mousedown",function(t){!function(t){r&&console.log("startDrag"),t.preventDefault(),y=u.getBoundingClientRect(),m=y.width/2,h=m,document.addEventListener("mousemove",Y,!1),document.addEventListener("mouseup",R,!1),K(t),Z()}(t)}),u.addEventListener("wheel",function(t){!function(t){t.preventDefault();var e,r=t.deltaY;0!==r&&(C>Math.abs(r)||!C)&&(C=Math.abs(r)),e=r/C*k*b.mouse_wheel_acceleration,B(Math.min(Math.max(p+e,b.angle_min),b.angle_max),!0),Z()}(t)}),u.addEventListener("touchstart",X,{passive:!1}),{set value(t){console.log("set value "+t),O(t),Z()},set config(t){b=Object.assign({},c,e,t),P(),W()},enableDebug:function(){r=!0},disableDebug:function(){r=!1}}};var n,o=r(0),a=(n=o)&&n.__esModule?n:{default:n}}])});